TCP并不能保证数据一定会被对方接收到，因为这是不可能的。它不是100%可靠的协议，它所能提供的是数据的可靠传递或故障的可靠通知。
### 三次握手
三次握手是指: 建立一个TCP连接时, 需要客户端和服务器总共发送3个包.

+ 第一次握手: 客户端发送一个SYN标识的包, Seq初始序列号x, 发送完成后客户端进入SYN_SEND状态.
+ 第二次握手: 服务器返回确认包(ACK)应答, 同时还要发送一个SYN包回去。ACK = x + 1,表示确认收到(客户端发来的Seq值 + 1)，Seq = y, 表示让客户端确认是否能收到。发送完成后服务端进入SYN_RCVD状态。
+ 第三次握手: 客户端再次发送确认包(ACK),ACK = y + 1, 表示确认收到服务器的包（服务端发来的Seq值 + 1）。客户端发送完毕后，进入ESTABLISHED状态，服务端接收到这个包，也进入ESTABLISHED状态, TCP握手结束。
  
### 四次挥手
TCP连接的断开需要发送四个包，所以称为四次挥手。
+ 第一次挥手: 客户端发送一个FIN标记的包，告诉服务器需要关闭连接，表示自己不用发送数据了，但是还可以接收数据。发送完成后，客户端进入FIN_WAIT_1状态。
+ 第二次挥手: 服务端发送一个ACK的确认包，告诉客户端接收到关闭的请求，但是还没有准备好。发送完成后，服务端进入CLOSE_WAIT状态，客户端收到这个包后，进入FIN_WAIT_2，等待服务器关闭连接。
+ 第三次挥手: 服务端准备好关闭连接时，发送FIN标记的包，告诉客户端准备关闭了。发送完成后，服务端进入LAST_ACK状态，等待客户端确认。
+ 第四次挥手: 客户端接收到服务端的关闭请求，再发送ACK标记的确认包，进入TIME_WAIT状态，等待服务端可能请求重传的ACK包。
服务端接收到ACK包后，关闭连接，进入CLOSED状态。
客户端在等待固定时间(两个最大段生命周期(MSL))后，没有接收到服务的ACK包，认为服务器已关闭连接，自己也关闭连接，进入CLOSED状态。

### TIME_WAIT
两个MSL时间长度，也就是在1-4分钟。Windows操作系统就是4分钟。